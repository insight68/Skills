# 财务审计文件格式说明

## 所需文件

财务审计需要以下 Excel 文件：

### 1. 资产负债表 (必需)

**文件说明**: 包含期初余额和期末余额的资产负债表

**必需列**:
- `科目`: 会计科目名称
- `期初余额`: 期初余额
- `期末余额`: 期末余额
- `类型`: 科目类型（资产/负债/所有者权益）- 用于验证资产负债平衡
- `金额`: 金额 - 用于计算各类型总计

**示例数据**:
| 科目 | 期初余额 | 期末余额 | 类型 | 金额 |
|------|----------|----------|------|------|
| 货币资金 | 100000 | 120000 | 资产 | 120000 |
| 应收账款 | 50000 | 45000 | 资产 | 45000 |
| 短期借款 | 20000 | 25000 | 负债 | 25000 |
| 未分配利润 | 30000 | 40000 | 所有者权益 | 40000 |

### 2. 科目变动明细表 (必需)

**文件说明**: 记录各科目的借方和贷方变动明细

**必需列**:
- `科目`: 会计科目名称
- `借方`: 借方发生额
- `贷方`: 贷方发生额

**可选列**:
- `日期`: 变动日期
- `凭证号`: 关联的凭证号
- `摘要`: 业务摘要

**示例数据**:
| 科目 | 借方 | 贷方 | 日期 | 凭证号 | 摘要 |
|------|------|------|------|--------|------|
| 货币资金 | 20000 | 0 | 2024-01-15 | 001 | 收回货款 |
| 应收账款 | 0 | 5000 | 2024-01-20 | 002 | 坏账核销 |

### 3. 利润表 (可选)

**文件说明**: 当期利润表

**必需列**:
- `项目`: 利润表项目名称
- `金额`: 项目金额

**示例数据**:
| 项目 | 金额 |
|------|------|
| 营业收入 | 500000 |
| 营业成本 | 300000 |
| 销售费用 | 50000 |
| 管理费用 | 30000 |
| 财务费用 | 10000 |

### 4. 利润明细表 (可选)

**文件说明**: 利润表各项目的明细，用于与利润表核对

**必需列**:
- `项目`: 利润项目名称（需与利润表项目一致）
- `金额`: 明细金额

**示例数据**:
| 项目 | 金额 |
|------|------|
| 营业收入 | 500000 |
| 主营业务收入 | 450000 |
| 其他业务收入 | 50000 |
| 营业成本 | 300000 |
| 主营业务成本 | 280000 |
| 其他业务成本 | 20000 |

### 5. 交易明细表 (可选)

**文件说明**: 完整的交易明细，用于追踪交易影响

**必需列**:
- `科目`: 受影响的科目
- `借方`: 借方金额
- `贷方`: 贷方金额

**可选列**:
- `日期`: 交易日期
- `凭证号`: 凭证号
- `摘要`: 交易摘要

**示例数据**:
| 日期 | 凭证号 | 科目 | 借方 | 贷方 | 摘要 |
|------|--------|------|------|------|------|
| 2024-01-01 | 001 | 货币资金 | 100000 | 0 | 收到投资款 |
| 2024-01-01 | 001 | 实收资本 | 0 | 100000 | 收到投资款 |

## 列名配置

如果您的 Excel 文件使用不同的列名，可以通过以下方式配置：

### 方式一：命令行参数

```bash
scripts/reconcile.py \
    --balance-sheet bs.xlsx \
    --account-changes ac.xlsx \
    --bs-sheet "资产负债表" \
    --ac-sheet "科目变动"
```

### 方式二：JSON 配置文件

创建一个 `config.json` 文件：

```json
{
  "balance_sheet": {
    "account": "科目",
    "opening": "期初余额",
    "closing": "期末余额",
    "type": "类型",
    "amount": "金额"
  },
  "account_changes": {
    "account": "科目",
    "debit": "借方发生额",
    "credit": "贷方发生额"
  },
  "income_statement": {
    "item": "利润项目",
    "amount": "本期金额"
  },
  "income_details": {
    "item": "项目名称",
    "amount": "明细金额"
  },
  "transactions": {
    "account": "会计科目",
    "debit": "借",
    "credit": "贷",
    "date": "交易日期",
    "voucher": "凭证编号"
  }
}
```

然后使用 `-c` 参数指定配置文件：

```bash
scripts/reconcile.py --balance-sheet bs.xlsx --account-changes ac.xlsx --config config.json
```

## 多 Sheet 支持

如果 Excel 文件包含多个 Sheet，可以通过以下参数指定：

- `--bs-sheet`: 资产负债表 Sheet（名称或索引）
- `--ac-sheet`: 科目变动表 Sheet（名称或索引）
- `--is-sheet`: 利润表 Sheet（名称或索引）
- `--id-sheet`: 利润明细表 Sheet（名称或索引）
- `--trans-sheet`: 交易明细表 Sheet（名称或索引）

**示例**:

```bash
scripts/reconcile.py \
    --balance-sheet financials.xlsx \
    --account-changes financials.xlsx \
    --income-statement financials.xlsx \
    --bs-sheet "资产负债表" \
    --ac-sheet "科目变动" \
    --is-sheet "利润表"
```
