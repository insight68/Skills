---
name: goose-adventure-game
description: ã€Šå°¼å°”æ–¯éª‘é¹…æ—…è¡Œè®°ã€‹æ–‡å­—å†’é™©æ¸¸æˆå¼•æ“ã€‚åˆ›å»ºä¸€ä¸ªåŸºäºPythonçš„äº’åŠ¨æ–‡å­—æ¸¸æˆï¼ŒåŒ…å«å®Œæ•´çš„å‰§æƒ…ç³»ç»Ÿã€çŠ¶æ€ç®¡ç†ã€å­˜æ¡£åŠŸèƒ½å’Œæˆå°±ç³»ç»Ÿã€‚å½“ç”¨æˆ·éœ€è¦ï¼šåˆ›å»ºæ–‡å­—å†’é™©æ¸¸æˆã€å¼€å‘äº’åŠ¨æ•…äº‹ç³»ç»Ÿã€æ„å»ºæ¸¸æˆå¼•æ“ã€å®ç°å­˜æ¡£ç®¡ç†ã€è®¾è®¡åˆ†æ”¯å‰§æƒ…æ—¶ä½¿ç”¨æ­¤skillã€‚
---

# é¹…éª‘é¹…å†’é™©æ¸¸æˆå¼•æ“

## æ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ–‡å­—å†’é™©æ¸¸æˆå¼•æ“ï¼Œä¸“ä¸ºã€Šå°¼å°”æ–¯éª‘é¹…æ—…è¡Œè®°ã€‹æ•…äº‹è®¾è®¡ã€‚æ¸¸æˆå¼•æ“æ”¯æŒï¼š

- **å‰§æƒ…èŠ‚ç‚¹ç³»ç»Ÿ** - åˆ†æ”¯å™äº‹ï¼Œå¤šä¸ªç»“å±€
- **çŠ¶æ€ç®¡ç†** - ç”Ÿå‘½å€¼ã€é“å¾·å€¼ã€å¤§å°å€¼ã€çŸ¥è¯†å€¼
- **å­˜æ¡£ç³»ç»Ÿ** - å¤šæ§½ä½å­˜æ¡£ï¼Œè‡ªåŠ¨ä¿å­˜
- **æˆå°±ç³»ç»Ÿ** - è¿½è¸ªç©å®¶æˆå°±
- **ç‰©å“æ ç®¡ç†** - æ”¶é›†å’Œä½¿ç”¨ç‰©å“
- **æ¡ä»¶è§¦å‘** - åŸºäºçŠ¶æ€çš„é€‰é¡¹è§£é”

## å¿«é€Ÿå¼€å§‹

### 1. è¿è¡Œæ¸¸æˆ

```bash
# ä½¿ç”¨ Python è¿è¡Œæ¸¸æˆå¼•æ“
python3 scripts/game_engine.py

# æˆ–ä½¿ç”¨ pnpmï¼ˆå¦‚æœéœ€è¦ï¼‰
pnpm run game
```

### 2. æ¸¸æˆæ–‡ä»¶ç»“æ„

```
goose-adventure-game/
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ game_engine.py      # æ¸¸æˆå¼•æ“ä¸»ç±»
â”‚   â”œâ”€â”€ game_script.json    # æ¸¸æˆå‰§æœ¬æ•°æ®
â”‚   â””â”€â”€ save_manager.py     # å­˜æ¡£ç®¡ç†å™¨
â”œâ”€â”€ saves/                  # å­˜æ¡£ç›®å½•ï¼ˆè‡ªåŠ¨åˆ›å»ºï¼‰
â””â”€â”€ SKILL.md               # æœ¬æ–‡æ¡£
```

### 3. åŸºæœ¬ä½¿ç”¨

```python
from scripts.game_engine import GameEngine, load_script_from_file

# åŠ è½½æ¸¸æˆè„šæœ¬
script = load_script_from_file("scripts/game_script.json")

# åˆ›å»ºæ¸¸æˆå¼•æ“
engine = GameEngine(script, save_dir="./saves")

# æ¸²æŸ“å½“å‰åœºæ™¯
scene = engine.render_scene()
print(f"{scene['title']}\n{scene['description']}")

# æ˜¾ç¤ºé€‰é¡¹
for choice in scene['choices']:
    print(f"{choice['index']}: {choice['text']}")

# ç©å®¶åšå‡ºé€‰æ‹©
engine.make_choice(0)  # é€‰æ‹©ç¬¬ä¸€ä¸ªé€‰é¡¹

# ä¿å­˜æ¸¸æˆ
engine.save_game("slot1")
```

## æ ¸å¿ƒåŠŸèƒ½

### 1. æ¸¸æˆçŠ¶æ€ç³»ç»Ÿ

æ¸¸æˆçŠ¶æ€åŒ…å«ä»¥ä¸‹å±æ€§ï¼š

| å±æ€§ | ç±»å‹ | èŒƒå›´ | è¯´æ˜ |
|------|------|------|------|
| `hp` | int | 0-100 | ç”Ÿå‘½å€¼ |
| `morality` | int | 0-100 | é“å¾·å€¼ï¼ˆå†³å®šç»“å±€ï¼‰ |
| `size` | int | 0-100 | å¤§å°å€¼ï¼ˆ0=æ‹‡æŒ‡å¤§å°ï¼Œ100=æ­£å¸¸ï¼‰ |
| `knowledge` | int | 0-1000 | çŸ¥è¯†å€¼ |
| `inventory` | list | - | ç‰©å“æ  |
| `achievements` | list | - | æˆå°±åˆ—è¡¨ |
| `flags` | dict | - | äº‹ä»¶æ ‡å¿— |

### 2. åœºæ™¯ç³»ç»Ÿ

æ¯ä¸ªåœºæ™¯åŒ…å«ï¼š

```json
{
  "id": "scene_id",
  "title": "åœºæ™¯æ ‡é¢˜",
  "description": "åœºæ™¯æè¿°",
  "choices": [
    {
      "text": "é€‰é¡¹æ–‡æœ¬",
      "next_scene": "ä¸‹ä¸€åœºæ™¯ID",
      "requirements": {
        "morality_min": 50,
        "has_item": "key"
      },
      "effects": {
        "moral_change": 10,
        "add_item": "key",
        "set_flag": {"met_npc": true}
      }
    }
  ]
}
```

### 3. æ¡ä»¶è§¦å‘ç³»ç»Ÿ

æ”¯æŒçš„è§¦å‘æ¡ä»¶ï¼š

- `has_item` - æ£€æŸ¥ç‰©å“
- `flag` - æ£€æŸ¥äº‹ä»¶æ ‡å¿—
- `morality_min/max` - é“å¾·å€¼èŒƒå›´
- `size_min/max` - å¤§å°å€¼èŒƒå›´
- `has_achievement` - æ£€æŸ¥æˆå°±

### 4. æ•ˆæœç³»ç»Ÿ

æ”¯æŒçš„æ•ˆæœç±»å‹ï¼š

- `add_item` / `remove_item` - ç‰©å“ç®¡ç†
- `hp_change` - ç”Ÿå‘½å€¼å˜åŒ–
- `size_change` - å¤§å°å€¼å˜åŒ–
- `set_flag` - è®¾ç½®äº‹ä»¶æ ‡å¿—
- `add_achievement` - æ·»åŠ æˆå°±
- `moral_change` - é“å¾·å€¼å˜åŒ–
- `knowledge_gain` - è·å¾—çŸ¥è¯†

## å­˜æ¡£ç³»ç»Ÿ

### ä½¿ç”¨å­˜æ¡£ç®¡ç†å™¨

```python
from scripts.save_manager import SaveManager

manager = SaveManager(save_dir="./saves")

# ä¿å­˜æ¸¸æˆ
manager.save_game("slot1", game_data)

# åŠ è½½æ¸¸æˆ
game_data = manager.load_game("slot1")

# åˆ—å‡ºæ‰€æœ‰å­˜æ¡£
saves = manager.list_saves()

# åˆ é™¤å­˜æ¡£
manager.delete_save("slot1")
```

### è‡ªåŠ¨ä¿å­˜

```python
from scripts.save_manager import AutoSaveManager

auto_save = AutoSaveManager(manager, auto_save_interval=5)

# æ¯ä¸ªåœºæ™¯å˜åŒ–åæ£€æŸ¥
auto_save.on_scene_change("autosave", game_data)

# å¼ºåˆ¶ä¿å­˜
auto_save.force_save("quicksave", game_data)
```

## æ¸¸æˆå‰§æœ¬ç¼–è¾‘

### æ·»åŠ æ–°åœºæ™¯

åœ¨ `game_script.json` çš„ `scenes` æ•°ç»„ä¸­æ·»åŠ ï¼š

```json
{
  "id": "my_new_scene",
  "chapter": 1,
  "title": "æ–°åœºæ™¯æ ‡é¢˜",
  "description": "åœºæ™¯æè¿°...",
  "choices": [
    {
      "text": "é€‰é¡¹1",
      "next_scene": "scene_a"
    },
    {
      "text": "é€‰é¡¹2",
      "next_scene": "scene_b",
      "requirements": {"morality_min": 50},
      "effects": {"moral_change": 10}
    }
  ]
}
```

### æ·»åŠ æ–°ç»“å±€

åœ¨ `game_script.json` çš„ `endings` æ•°ç»„ä¸­æ·»åŠ ï¼š

```json
{
  "id": "special_ending",
  "title": "ç‰¹æ®Šç»“å±€",
  "description": "ç»“å±€æè¿°...",
  "requirements": {
    "morality_min": 80,
    "flag": ["special_event", true]
  }
}
```

## æˆå°±ç³»ç»Ÿ

### é¢„å®šä¹‰æˆå°±

æ¸¸æˆåŒ…å«ä»¥ä¸‹æˆå°±ï¼š

- ğŸ¥š åˆç« ï¼šå˜å°çš„äºº - å®Œæˆç¬¬ä¸€ç« 
- ğŸ•Šï¸ ç¿…è†€çš„å®ˆæŠ¤è€… - æ•‘ä¸‹è«é¡¿
- ğŸ¦Š ç‹ç‹¸çš„æ­»æ•Œ - å¸®åŠ©é›ç¾¤å¯¹æŠ—ç‹ç‹¸
- ğŸŒ è‡ªç„¶è§‚å¯Ÿè€… - çŸ¥è¯†å€¼è¾¾åˆ°100
- ğŸ“š å°å°åšç‰©å­¦å®¶ - çŸ¥è¯†å€¼è¾¾åˆ°300
- ğŸ—ºï¸ åœ°ç†å¤§å¸ˆ - çŸ¥è¯†å€¼è¾¾åˆ°500
- â­ æ™ºæ…§ä¹‹æ˜Ÿ - çŸ¥è¯†å€¼è¾¾åˆ°800
- ğŸ’– å–„è‰¯ä¹‹å¿ƒ - é“å¾·å€¼è¾¾åˆ°80
- ğŸ¦¸â€â™‚ï¸ çœŸæ­£çš„å‹‡è€… - è¾¾æˆå®Œç¾ç»“å±€

### æ·»åŠ è‡ªå®šä¹‰æˆå°±

åœ¨åœºæ™¯çš„æ•ˆæœä¸­æ·»åŠ ï¼š

```json
{
  "effects": {
    "add_achievement": "ğŸ† è‡ªå®šä¹‰æˆå°±"
  }
}
```

## æ¸¸æˆè°ƒè¯•

### æŸ¥çœ‹å½“å‰çŠ¶æ€

```python
state = engine.state
print(f"ç”Ÿå‘½å€¼: {state.hp}")
print(f"é“å¾·å€¼: {state.morality}")
print(f"çŸ¥è¯†å€¼: {state.knowledge}")
print(f"ç‰©å“: {state.inventory}")
print(f"æˆå°±: {state.achievements}")
```

### è·³è½¬åˆ°æŒ‡å®šåœºæ™¯

```python
engine.state.current_scene = "target_scene_id"
```

### è®¾ç½®çŠ¶æ€å€¼

```python
engine.state.morality = 80
engine.state.knowledge = 500
engine.state.inventory.append("special_item")
```

## æ‰©å±•æ¸¸æˆ

### åˆ›å»ºè‡ªå®šä¹‰æ•…äº‹

1. å¤åˆ¶ `game_script.json` ä½œä¸ºæ¨¡æ¿
2. ä¿®æ”¹ `game_info` ä¸­çš„æ ‡é¢˜å’Œæè¿°
3. ç¼–è¾‘æˆ–æ›¿æ¢ `scenes` æ•°ç»„ä¸­çš„åœºæ™¯
4. æ›´æ–° `endings` æ•°ç»„ä¸­çš„ç»“å±€

### æ·»åŠ æ–°åŠŸèƒ½

æ¸¸æˆå¼•æ“é‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œå¯ä»¥è½»æ¾æ‰©å±•ï¼š

- åœ¨ `GameEngine` ç±»ä¸­æ·»åŠ æ–°æ–¹æ³•
- åœ¨ `GameState` ç±»ä¸­æ·»åŠ æ–°å±æ€§
- åˆ›å»ºæ–°çš„æ•ˆæœç±»å‹

## æœ€ä½³å®è·µ

### æ¸¸æˆè®¾è®¡

1. **é“å¾·é€‰æ‹©** - æä¾›æœ‰æ„ä¹‰çš„é€‰æ‹©ï¼Œè®©ç©å®¶æ€è€ƒ
2. **å¾ªåºæ¸è¿›** - ä»ç®€å•å¼€å§‹ï¼Œé€æ­¥å¢åŠ å¤æ‚æ€§
3. **åé¦ˆæ¸…æ™°** - è®©ç©å®¶äº†è§£é€‰æ‹©çš„åæœ
4. **å¤šç»“å±€** - æ ¹æ®ç©å®¶é€‰æ‹©æä¾›ä¸åŒç»“å±€

### å‰§æƒ…ç¼–å†™

1. **æè¿°ç”ŸåŠ¨** - ä½¿ç”¨æ„Ÿå®˜è¯­è¨€æè¿°åœºæ™¯
2. **é€‰é¡¹æ˜ç¡®** - æ¯ä¸ªé€‰é¡¹åº”è¯¥æ¸…æ™°è¡¨è¾¾åæœ
3. **é€»è¾‘ä¸€è‡´** - ç¡®ä¿å‰§æƒ…é€»è¾‘è¿è´¯
4. **çŸ¥è¯†èå…¥** - åœ¨å‰§æƒ…ä¸­è‡ªç„¶åœ°èå…¥çŸ¥è¯†

### æŠ€æœ¯å®ç°

1. **æ•°æ®é©±åŠ¨** - å°†æ•…äº‹æ•°æ®ä¸å¼•æ“ä»£ç åˆ†ç¦»
2. **å¯æµ‹è¯•æ€§** - ç¡®ä¿æ¯ä¸ªåŠŸèƒ½éƒ½å¯ä»¥ç‹¬ç«‹æµ‹è¯•
3. **é”™è¯¯å¤„ç†** - ä¼˜é›…å¤„ç†åŠ è½½å¤±è´¥ç­‰æƒ…å†µ
4. **æ€§èƒ½ä¼˜åŒ–** - é¿å…é‡å¤åŠ è½½èµ„æº
